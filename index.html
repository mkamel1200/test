<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trial Designer</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    .draggable {
      cursor: grab;
    }
    .dropzone {
      min-height: 200px;
      border: 2px dashed #ccc;
      padding: 1rem;
    }
  </style>
</head>
<body class="bg-gray-100 font-sans">
  <div class="max-w-5xl mx-auto p-6">
    <h1 class="text-3xl font-bold text-center text-blue-800 mb-6">🧪 Trial Designer</h1>

    <!-- Drag items -->
    <div class="grid grid-cols-3 gap-4 mb-6">
      <div class="bg-white p-4 shadow rounded draggable" draggable="true" data-value="30">
        💉 Add Infusion (Invasiveness +2)
      </div>
      <div class="bg-white p-4 shadow rounded draggable" draggable="true" data-value="20">
        🧪 Add Imaging (Radiation +1)
      </div>
      <div class="bg-white p-4 shadow rounded draggable" draggable="true" data-value="15">
        ⏱️ Long Visit (Duration +1)
      </div>
      <div class="bg-white p-4 shadow rounded draggable" draggable="true" data-value="10">
        🧭 Remote Diary (Logistics +1)
      </div>
      <div class="bg-white p-4 shadow rounded draggable" draggable="true" data-value="25">
        🚗 Travel >1hr (Travel Burden +2)
      </div>
    </div>

    <!-- Drop zone -->
    <div class="dropzone bg-white rounded shadow p-6 text-center">
      <p class="text-gray-500">Drag & drop trial components here to build your study</p>
      <div id="items" class="mt-4 space-y-2"></div>
    </div>

    <!-- Output -->
    <div class="mt-6 text-center">
      <p class="text-xl font-semibold text-green-700">Estimated Stipend:</p>
      <p id="stipend" class="text-3xl font-bold text-green-900">$0</p>
      <p id="comment" class="mt-2 text-sm italic text-gray-600"></p>
    </div>
  </div>

  <script>
    let total = 0;
    const dropzone = document.querySelector(".dropzone");
    const stipendOutput = document.getElementById("stipend");
    const comment = document.getElementById("comment");
    const itemsDiv = document.getElementById("items");

    document.querySelectorAll(".draggable").forEach(el => {
      el.addEventListener("dragstart", e => {
        e.dataTransfer.setData("text/plain", el.outerHTML);
        e.dataTransfer.setData("value", el.dataset.value);
      });
    });

    dropzone.addEventListener("dragover", e => {
      e.preventDefault();
      dropzone.classList.add("border-blue-400");
    });

    dropzone.addEventListener("dragleave", () => {
      dropzone.classList.remove("border-blue-400");
    });

    dropzone.addEventListener("drop", e => {
      e.preventDefault();
      const value = parseInt(e.dataTransfer.getData("value"));
      const html = e.dataTransfer.getData("text/plain");
      itemsDiv.insertAdjacentHTML("beforeend", html);
      total += value;
      updateStipend();
    });

    function updateStipend() {
      stipendOutput.textContent = `$${total}`;
      if (total < 75) comment.textContent = "💡 Consider more trial burden to justify stipend.";
      else if (total < 150) comment.textContent = "✅ Moderate burden, stipend looks aligned.";
      else comment.textContent = "⚠️ High burden — ensure IRB justification is solid.";
    }
  </script>
</body>
</html>
